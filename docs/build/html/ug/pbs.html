

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="pt-BR" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="pt-BR" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. PBSPro &mdash; documentação lobocug-at-nacad 0.0.5</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Buscar" href="../search.html" />
    <link rel="next" title="1. Python" href="python.html" />
    <link rel="prev" title="2. Module Environment" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> lobocug-at-nacad
          

          
            
            <img src="../_static/logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Conteúdo:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introdução</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">2. Module Environment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. PBSPro</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introducao">3.1. Introdução</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pbs-comandos">3.2. PBS Comandos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">3.2.1. Environment variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exemplos-de-scripts">3.3. Exemplos de scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#script-basico">3.3.1. Script Básico</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openmp">3.3.2. OpenMP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mpi">3.3.3. MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submissao-de-job">3.4. Submissão de job</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submetendo-um-batch-job">3.4.1. Submetendo um batch job</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#acompanhando-o-status-do-job">3.4.1.1. Acompanhando o status do job</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submetendo-um-job-interativo">3.4.2. Submetendo um job interativo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencia-entre-jobs">3.4.3. Dependência entre jobs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Aplicação:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python.html">1. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="paraview.html">2. Paraview</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lobocug-at-nacad</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>PBSPro</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pbspro">
<h1><a class="toc-backref" href="#id4"><span class="section-number">3. </span>PBSPro</a><a class="headerlink" href="#pbspro" title="Link permanente para este título">¶</a></h1>
<div class="contents topic" id="conteudo">
<p class="topic-title">Conteúdo</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pbspro" id="id4">PBSPro</a></p>
<ul>
<li><p><a class="reference internal" href="#introducao" id="id5">Introdução</a></p></li>
<li><p><a class="reference internal" href="#pbs-comandos" id="id6">PBS Comandos</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-variables" id="id7">Environment variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#exemplos-de-scripts" id="id8">Exemplos de scripts</a></p>
<ul>
<li><p><a class="reference internal" href="#script-basico" id="id9">Script Básico</a></p></li>
<li><p><a class="reference internal" href="#openmp" id="id10">OpenMP</a></p></li>
<li><p><a class="reference internal" href="#mpi" id="id11">MPI</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#submissao-de-job" id="id12">Submissão de job</a></p>
<ul>
<li><p><a class="reference internal" href="#submetendo-um-batch-job" id="id13">Submetendo um batch job</a></p>
<ul>
<li><p><a class="reference internal" href="#acompanhando-o-status-do-job" id="id14">Acompanhando o status do job</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#submetendo-um-job-interativo" id="id15">Submetendo um job interativo</a></p></li>
<li><p><a class="reference internal" href="#dependencia-entre-jobs" id="id16">Dependência entre jobs</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introducao">
<h2><a class="toc-backref" href="#id5"><span class="section-number">3.1. </span>Introdução</a><a class="headerlink" href="#introducao" title="Link permanente para este título">¶</a></h2>
<p>O <a class="reference external" href="https://www.altair.com/pbs-professional/">PBS Pro</a> é um <em>job scheduler open-source</em> baseado no original PBS code desenvolvido pela NASA. Agora a Altair Engineering possui e mantém o PBS Pro Scheduler.</p>
</div>
<div class="section" id="pbs-comandos">
<h2><a class="toc-backref" href="#id6"><span class="section-number">3.2. </span>PBS Comandos</a><a class="headerlink" href="#pbs-comandos" title="Link permanente para este título">¶</a></h2>
<table class="docutils align-center" id="id1">
<caption><span class="caption-text">Comandos básicos</span><a class="headerlink" href="#id1" title="Link Permanente para essa tabela">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Comando</p></th>
<th class="head"><p>Descrição</p></th>
<th class="head"><p>Exemplo</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qsub</span></code></p></td>
<td><p>Submite um job</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">myjob</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qstat</span></code></p></td>
<td><p>Mostra o status dos jobs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qstat</span> <span class="pre">-u</span> <span class="pre">user1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qdel</span></code></p></td>
<td><p>Delete um job</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qdel</span> <span class="pre">212345</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qhold</span></code></p></td>
<td><p>Suspende um job</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qhold</span> <span class="pre">200123</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">qrls</span></code></p></td>
<td><p>Libera o job em hold</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qrls</span> <span class="pre">-h</span> <span class="pre">u</span> <span class="pre">200123</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">qrerun</span></code></p></td>
<td><p>Termina a execução e submete novamente o job</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">qrerun</span> <span class="pre">200012</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tracejob</span></code></p></td>
<td><p>Imprime informações de log do job</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tracejob</span> <span class="pre">201012</span></code></p></td>
</tr>
</tbody>
</table>
<div class="section" id="environment-variables">
<h3><a class="toc-backref" href="#id7"><span class="section-number">3.2.1. </span>Environment variables</a><a class="headerlink" href="#environment-variables" title="Link permanente para este título">¶</a></h3>
<p>O job scheduler cria automaticamente variáveis de ambiente que estão disponíveis para serem utilizadas nos scripts de trabalho quando estão sendo executados em nós de computação de cluster, junto com variáveis Linux padrão. As variáveis são:</p>
<table class="docutils align-center" id="id2">
<caption><span class="caption-text">Environment variables</span><a class="headerlink" href="#id2" title="Link Permanente para essa tabela">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_JOBID</span></code></p></td>
<td><p>Identificador do job. Fornecido pelo PBS quando um job é submetido.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_JOBNAME</span></code></p></td>
<td><p>Nome do job fornecido pelo usuário. Criado na execução.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_NODEFILE</span></code></p></td>
<td><p>Nome do arquivo contendo uma lista dos vnodes atribuídos ao trabalho.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_O_PATH</span></code></p></td>
<td><p>Valor no PATH do ambiente de submissão</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_O_WORKDIR</span></code></p></td>
<td><p>PATH absoluto para o diretório onde o comando <code class="docutils literal notranslate"><span class="pre">qsub</span></code> foi executado.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code></p></td>
<td><p>Diretório temporário do job.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NCPUS</span></code></p></td>
<td><p>Número de threads padrão do vnode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code></p></td>
<td><p>Número de threads padrão do vnode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_ARRAY_ID</span></code></p></td>
<td><p>Identificador do job array.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">PBS_ARRAY_INDEX</span></code></p></td>
<td><p>Número do índice de subtrabalho na matriz de trabalhos.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="exemplos-de-scripts">
<span id="exemplos"></span><h2><a class="toc-backref" href="#id8"><span class="section-number">3.3. </span>Exemplos de scripts</a><a class="headerlink" href="#exemplos-de-scripts" title="Link permanente para este título">¶</a></h2>
<p>Os exemplos dos scripts para o PBS estão disponiveis no servidor de login no diretório <code class="docutils literal notranslate"><span class="pre">/sw/share/doc</span></code>. Conforme descrito em <a class="reference internal" href="introduction.html"><span class="doc">Introdução</span></a>, cada nó de processamento possui 24 cores/48 threads.</p>
<div class="section" id="script-basico">
<h3><a class="toc-backref" href="#id9"><span class="section-number">3.3.1. </span>Script Básico</a><a class="headerlink" href="#script-basico" title="Link permanente para este título">¶</a></h3>
<p>O script abaixo pode ser usado como base para qualquer tipo de aplicação.</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#PBS -l select=1:ncpus=48</span>
<span class="c1">#PBS -l walltime=01:00:00</span>
<span class="c1">#PBS -j oe</span>
<span class="c1">#PBS -V</span>
<span class="c1">#PBS -N &lt;jobname&gt;</span>

<span class="c1"># load modules</span>
module load module1 <span class="o">[</span>module2<span class="o">]</span> <span class="o">[</span>...<span class="o">]</span>
<span class="c1"># change directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">PBS_O_WORKDIR</span><span class="si">}</span>

./prog
</pre></div>
</td></tr></table></div>
<table class="docutils align-center" id="id3">
<caption><span class="caption-text">Descrição detalhada do job</span><a class="headerlink" href="#id3" title="Link Permanente para essa tabela">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Linha</p></th>
<th class="head"><p>Descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Shell utilizado para os comandos do job</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">select=1</span></code> aloca 1 node. <code class="docutils literal notranslate"><span class="pre">ncpus=48</span></code> aloca todos os 48 threads disponíveis no node</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Total do tempo de processamento (<em>walltime</em>) do job</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Os arquivos de saída e erro são direcionados para um único arquivo</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>(Opcional) As variáveis de ambiente do servidor de submissão são enviadas para o job</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Define o nome do job</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Módulos necessários para a execução do programa</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>Muda para o mesmo diretório em que o comando <code class="docutils literal notranslate"><span class="pre">qsub</span></code> foi executado</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Execução do programa <code class="docutils literal notranslate"><span class="pre">prog</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Caso seja de interesse pode-se incluir duas linhas com os parâmetros <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-m</span> <span class="pre">ae</span></code> e <code class="docutils literal notranslate"><span class="pre">#PBS</span> <span class="pre">-M</span> <span class="pre">sua_conta&#64;seu_dominio.com.br</span></code>, logo após a linha <em>6</em>, caso queiram receber um e-mail com informações de quando o job terminar ou for abortado. Caso use esta opção, por favor, verifique se o seu e-mail foi preenchido <strong>corretamente</strong>.</p>
</div>
</div>
<div class="section" id="openmp">
<h3><a class="toc-backref" href="#id10"><span class="section-number">3.3.2. </span>OpenMP</a><a class="headerlink" href="#openmp" title="Link permanente para este título">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="hll"><span class="c1">#PBS -l select=1:ncpus=48:ompthreads=24</span>
</span><span class="c1">#PBS -l walltime=01:00:00</span>
<span class="c1">#PBS -j oe</span>
<span class="c1">#PBS -V</span>
<span class="c1">#PBS -N OpenMP</span>

<span class="c1"># load modules</span>
module load intel/2019.4
<span class="c1"># change directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">PBS_O_WORKDIR</span><span class="si">}</span>
<span class="c1"># environment (if necessary)</span>
<span class="hll"><span class="c1">#export OMP_NUM_THREADS=24</span>
</span><span class="c1"># run</span>
./prog
</pre></div>
</div>
<p>Repare nas linhas em destaque. A quantidade de threads de um job pode ser definida pelo PBS incluindo o parâmetro <code class="docutils literal notranslate"><span class="pre">:ompthreads=24</span></code> ou descomentando a linha do comando <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OMP_NUM_THREADS=24</span></code>.</p>
</div>
<div class="section" id="mpi">
<h3><a class="toc-backref" href="#id11"><span class="section-number">3.3.3. </span>MPI</a><a class="headerlink" href="#mpi" title="Link permanente para este título">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="hll"><span class="c1">#PBS -l select=2:ncpus=48:mpiprocs=24</span>
</span><span class="c1">#PBS -l walltime=01:00:00</span>
<span class="c1">#PBS -j oe</span>
<span class="c1">#PBS -V</span>
<span class="c1">#PBS -N mpi-intel</span>

<span class="c1"># load modules</span>
module load intel/2019.4
<span class="c1"># change directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">PBS_O_WORKDIR</span><span class="si">}</span>
<span class="c1"># run</span>
<span class="hll">mpirun ./prog
</span></pre></div>
</div>
<p>Repare nas linhas em destaque. A quantidade de processos MPI por nó de processamento pode ser definida pelo PBS incluindo o parâmetro <code class="docutils literal notranslate"><span class="pre">:mpiprocs=24</span></code>. Desta maneira o parâmetro <code class="docutils literal notranslate"><span class="pre">-np=48</span></code> do <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> pode ser omitido, isto é, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">nodes</span> <span class="pre">x</span> <span class="pre">24</span> <span class="pre">procs</span> <span class="pre">=</span> <span class="pre">48</span></code>. Isto é uma grande vantagem pois facilita a manutenção do job caso haja alguma modificação na quantidade de processos MPI. Bastando para isso modificar apenas a primeira linha do job.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>As bibliotecas MPI do compilador Intel são carregadas automaticamente ao carregar o module do compilador Intel. Neste exemplo, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">intel/2019.4</span></code>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Dica</p>
<p>Se o seu programa usufrui das threads, os parâmetros <code class="docutils literal notranslate"><span class="pre">mpiprocs</span></code> e <code class="docutils literal notranslate"><span class="pre">ompthreads</span></code> podem ser <strong>omitidos</strong> ou modificados para <code class="docutils literal notranslate"><span class="pre">:mpiprocs=48</span></code> ou  <code class="docutils literal notranslate"><span class="pre">:ompthreads=48</span></code>, caso contrário mantenham eles como <code class="docutils literal notranslate"><span class="pre">24</span></code> que corresponde ao número de cores.</p>
</div>
</div>
</div>
<div class="section" id="submissao-de-job">
<h2><a class="toc-backref" href="#id12"><span class="section-number">3.4. </span>Submissão de job</a><a class="headerlink" href="#submissao-de-job" title="Link permanente para este título">¶</a></h2>
<div class="admonition important">
<p class="admonition-title">Importante</p>
<p>O job scheduler dá prioridade aos jobs que solicitam menos recursos. É importante salientar que o preenchimento correto do parâmetro <code class="docutils literal notranslate"><span class="pre">walltime</span></code> pode acelerar a execução do seu job. Durante a operação do cluster, as vezes, é possível fazer alocações manuais e neste caso apenas jobs curtos são selecionados.</p>
</div>
<div class="section" id="submetendo-um-batch-job">
<h3><a class="toc-backref" href="#id13"><span class="section-number">3.4.1. </span>Submetendo um batch job</a><a class="headerlink" href="#submetendo-um-batch-job" title="Link permanente para este título">¶</a></h3>
<p>Usando como base um dos jobs scripts de exemplo, mostrados anteriormente no item <a class="reference internal" href="#exemplos"><span class="std std-ref">Exemplos de scripts</span></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user1@service1:~/test&gt; qsub mpi-intel.job
<span class="m">233180</span>.service1
</pre></div>
</div>
<div class="section" id="acompanhando-o-status-do-job">
<h4><a class="toc-backref" href="#id14"><span class="section-number">3.4.1.1. </span>Acompanhando o status do job</a><a class="headerlink" href="#acompanhando-o-status-do-job" title="Link permanente para este título">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user1@service1:~/test&gt; qstat -u user1
service1:
                                                            Req<span class="s1">&#39;d  Req&#39;</span>d   Elap
Job ID          Username Queue    Jobname    SessID NDS TSK Memory Time  S Time
--------------- -------- -------- ---------- ------ --- --- ------ ----- - -----
<span class="m">233181</span>.service1 user1    workq    mpi-intel     --    <span class="m">2</span>  <span class="m">96</span>    --  <span class="m">01</span>:00 Q   --
</pre></div>
</div>
<p>Neste exemplo, o status do job é <code class="docutils literal notranslate"><span class="pre">Q</span></code>. O status de um job pode ser:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code>: job sendo executado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Q</span></code>: está na fila esperando recurso para ser executado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">H</span></code>: job em hold</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code>: job suspenso</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code>: job terminando</p></li>
</ul>
</div>
</div>
<div class="section" id="submetendo-um-job-interativo">
<h3><a class="toc-backref" href="#id15"><span class="section-number">3.4.2. </span>Submetendo um job interativo</a><a class="headerlink" href="#submetendo-um-job-interativo" title="Link permanente para este título">¶</a></h3>
<p>Para submeter um job interativo deve usar o comando <code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-I</span></code>. O <em>job scheduler</em> procurará um nó de computação disponível e fornecerá um shell de logon, se houver algum disponível. Neste exemplo, o node alocado foi o <code class="docutils literal notranslate"><span class="pre">r2i2n9</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user1@service1:~&gt; qsub -I
qsub: waiting <span class="k">for</span> job <span class="m">233174</span>.service1 to start
qsub: job <span class="m">233174</span>.service1 ready

Directory: /home/users/user1
Thu Aug  <span class="m">6</span> <span class="m">14</span>:27:18 UTC <span class="m">2020</span>
user1@r2i2n9:~&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para executar aplicativos gráficos em uma sessão interativa, adicione no comando a opção <code class="docutils literal notranslate"><span class="pre">-X</span></code>, que permite o encaminhamento da interface gráfica. Por exemplo, <code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-I</span> <span class="pre">-X</span></code> ou <code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-IX</span></code>. Pode-se adicionar também as variáveis de ambiente do servidor incluindo a opção <code class="docutils literal notranslate"><span class="pre">-V</span></code>, obtendo o seguinte comando <code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-I</span> <span class="pre">-X</span> <span class="pre">-V</span></code> ou <code class="docutils literal notranslate"><span class="pre">qsub</span> <span class="pre">-IXV</span></code>.</p>
</div>
</div>
<div class="section" id="dependencia-entre-jobs">
<h3><a class="toc-backref" href="#id16"><span class="section-number">3.4.3. </span>Dependência entre jobs</a><a class="headerlink" href="#dependencia-entre-jobs" title="Link permanente para este título">¶</a></h3>
<p>O PBS permite que você especifique dependências entre dois ou mais jobs. As dependências são úteis para uma variedade de tarefas, como:</p>
<ol class="arabic simple">
<li><p>Especificar a ordem em que os jobs devem ser executados</p></li>
<li><p>Solicitar a execução de um trabalho apenas se ocorrer um erro em outro trabalho</p></li>
<li><p>Reter trabalhos até que um determinado trabalho inicie ou conclua a execução</p></li>
</ol>
<p>A opção <code class="docutils literal notranslate"><span class="pre">-W</span> <span class="pre">depend=dependency_list</span></code> do <code class="docutils literal notranslate"><span class="pre">qsub</span></code> define a dependência entre vários trabalhos. As opções mais comuns são <code class="docutils literal notranslate"><span class="pre">after:&lt;jobid&gt;</span></code> e <code class="docutils literal notranslate"><span class="pre">afterok:&lt;jobid&gt;</span></code>, que correspondem respectivamente executar ao término do <em>&lt;jobid&gt;</em> e executar <strong>apenas</strong> se o <em>&lt;jobid&gt;</em> terminar com <code class="docutils literal notranslate"><span class="pre">EXIT</span> <span class="pre">STATUS=0</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>user1@service1:~/test&gt; qsub mpi-intel.job
<span class="m">233545</span>.service1

user1@service1:~/test&gt; qsub -W <span class="nv">depend</span><span class="o">=</span>afterok:233545 report.job
<span class="m">233546</span>.service1
user1@service1:~/test&gt; qstat -u user1

service1:
                                                            Req<span class="s1">&#39;d  Req&#39;</span>d   Elap
Job ID          Username Queue    Jobname    SessID NDS TSK Memory Time  S Time
--------------- -------- -------- ---------- ------ --- --- ------ ----- - -----
<span class="m">233545</span>.service1 user1    workq    mpi-intel   <span class="m">12345</span>   <span class="m">2</span>  <span class="m">96</span>    --  <span class="m">01</span>:00 R <span class="m">00</span>:01
<span class="m">233546</span>.service1 user1    workq    <span class="nb">test</span>          --    <span class="m">1</span>  <span class="m">48</span>    --  <span class="m">01</span>:00 H   --
</pre></div>
</div>
<p>Observe que o job ficará em <code class="docutils literal notranslate"><span class="pre">HOLD</span></code> até o job anterior terminar.</p>
<div class="admonition-maiores-informacoes admonition">
<p class="admonition-title">Maiores informações</p>
<p>Através do comando <code class="docutils literal notranslate"><span class="pre">man</span></code> ou do <a class="reference external" href="https://www.altair.com/pbs-works-documentation/">PBS Professional User’s Guide</a>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="python.html" class="btn btn-neutral float-right" title="1. Python" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="2. Module Environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, NACAD-COPPE-UFRJ

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>